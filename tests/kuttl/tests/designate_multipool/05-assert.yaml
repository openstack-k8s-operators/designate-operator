apiVersion: designate.openstack.org/v1beta1
kind: Designate
metadata:
  name: designate
status:
  designateBackendbind9ReadyCount: 2  # Now only 2 replicas after pool2 removed
  conditions:
  - message: Setup complete
    reason: Ready
    status: "True"
    type: Ready
  - message: Setup complete
    reason: Ready
    status: "True"
    type: DesignateBackendbind9Ready
---
# Verify that only 2 StatefulSets remain (default and pool1)
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: designate-backendbind9-pool0
  labels:
    pool: default
    pool-index: "0"
status:
  readyReplicas: 1
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: designate-backendbind9-pool1
  labels:
    pool: pool1
    pool-index: "1"
status:
  readyReplicas: 1
---
# Verify that pool2 StatefulSet was deleted
apiVersion: kuttl.dev/v1beta1
kind: TestAssert
commands:
  - script: |
      # Check that pool2 StatefulSet no longer exists
      if oc get statefulset designate-backendbind9-pool2 -n $NAMESPACE 2>/dev/null; then
        echo "ERROR: designate-backendbind9-pool2 StatefulSet still exists after pool removal"
        exit 1
      fi
      echo "SUCCESS: designate-backendbind9-pool2 StatefulSet was successfully deleted"
      exit 0
